# コーディング規約

## 1. 全般的なルール

### 1.1 ファイル構成
- ファイルの文字エンコードはUTF-8を使用
- 改行コードはLFを使用
- ファイル末尾には空行を1行入れる
- 1ファイルには1つのトップレベルクラスのみを定義

### 1.2 パッケージ構成
```
javavm/
├── classloader/     # クラスローダー関連
├── execution/       # 実行エンジン関連
├── memory/         # メモリ管理関連
└── native/         # ネイティブインターフェース関連
```

## 2. 命名規則

### 2.1 共通ルール
- 略語は避け、明確な名前を使用する
- 単語の省略は一般的に認知されているものを除き使用しない

### 2.2 具体的な命名規則
- パッケージ名: 小文字のみを使用（例: `javavm.classloader`）
- クラス名: UpperCamelCase（例: `ClassLoader`）
- メソッド名: lowerCamelCase（例: `loadClass`）
- 変数名: lowerCamelCase（例: `stackFrame`）
- 定数名: UPPER_SNAKE_CASE（例: `MAX_STACK_SIZE`）

## 3. コードフォーマット

### 3.1 インデント・スペース
- インデントは4スペースを使用
- タブ文字は使用しない
- 行末のスペースは削除

### 3.2 中括弧
```java
// 正しい例
if (condition) {
    doSomething();
}

// 間違った例
if (condition)
{
    doSomething();
}
```

### 3.3 行の長さ
- 1行の最大長は120文字
- import文は80文字を超えても可

## 4. ドキュメンテーション

### 4.1 Javadoc
- 公開APIには必ずJavadocを記述
- 説明、パラメータ、返り値、例外を明記

```java
/**
 * クラスをロードし、必要な初期化を行います。
 *
 * @param className ロードするクラスの完全修飾名
 * @return ロードされたクラスオブジェクト
 * @throws ClassNotFoundException クラスが見つからない場合
 */
public Class loadClass(String className) throws ClassNotFoundException {
    // 実装
}
```

### 4.2 インラインコメント
- 複雑なロジックには説明コメントを付ける
- TODO/FIXMEコメントには課題番号を含める

## 5. プログラミングプラクティス

### 5.1 例外処理
- 例外は適切な粒度で定義
- catch句は具体的な例外を指定
- 例外は適切にログ出力

### 5.2 リソース管理
- try-with-resourcesを積極的に使用
- ファイルやストリームは確実にクローズ
- メモリリークを防ぐため、適切なリソース解放を行う

### 5.3 並行処理
- 共有リソースへのアクセスは同期化
- デッドロックを防ぐため、ロックの順序を一貫させる
- volatile変数の使用は最小限に

## 6. テストコード

### 6.1 テストの命名
- テストクラス: 対象クラス名 + "Test"
- テストメソッド: 「何をテストするか」が分かる名前

### 6.2 テストの構造
- 各テストは独立して実行可能
- セットアップとクリーンアップを適切に実施
- テストデータは明確に定義

## 7. バージョン管理

### 7.1 コミットメッセージ
```
[種別] 要約

詳細な説明
```

種別:
- feat: 新機能
- fix: バグ修正
- docs: ドキュメントのみの変更
- test: テストコードの変更
- refactor: リファクタリング